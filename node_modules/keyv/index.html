<!DOCTYPE html><html lang=""><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="apple-touch-icon" sizes="57x57" href="/assets/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/assets/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/assets/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/assets/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/assets/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/assets/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/assets/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png"/><link rel="manifest" href="/assets/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#000000"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="apple-mobile-web-app-title" content="inspire korea"/><meta name="twitter:title" content=""/><meta name="twitter:description" content=""/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@DevYakuza"/><meta name="twitter:creator" content="@DevYakuza"/><title> - </title><meta name="description" content="책이나 자료를 통해 얻은 영감과 인사이트를 공유하여, 다른 분들도 영감을 얻기를 바랍니다."/><meta property="og:locale" content="ko"/><meta name="author" content="dev.yakuza@gmail.com"/><meta name="og:title" content=""/><meta name="og:description" content=""/><meta property="og:url" content="https://ink.posstree.com/node_modules/keyv/"/><meta property="og:site_name" content=""/><meta property="og:image" content="https://ink.posstree.com"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-01-11 17:21:04 +0900"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125408913-2"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-125408913-2");</script><script data-ad-client="ca-pub-7987914246691031" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR" rel="stylesheet"/><link rel="stylesheet" href="/assets/vendor/bootstrap/css/bootstrap.min.css"/><link rel="stylesheet" href="/assets/vendor/font-awesome/css/font-awesome.min.css"/><link rel="stylesheet" href="/assets/main.css?v=20250111"/><link rel="alternate" type="application/rss+xml" title="[ink] 인스파이어 코리아" href="/feed.xml"/><script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "dev.yakuza",
      "url": "https://ink.posstree.com/",
      "sameAs": [
        "https://www.facebook.com/yakuza.dev.54",
        "https://www.instagram.com/dev_yakuza/",
        "https://twitter.com/DevYakuza"
      ]
    }
  </script><script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://ink.posstree.com/",
      "logo": "https://ink.posstree.com/assets/images/icon.jpg"
    }
  </script><link rel="stylesheet" href="/assets/highlight/railscasts.css"/><script src="/assets/highlight/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="/assets//vendor/lazysizes/lazysizes.min.js" async=""></script></head><body><nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav"><div class="container"><a class="navbar-brand" href="/"><img src="/assets/images/icon.png" alt="dev.yakuza blog logo"/> inspire korea </a><div class="navbar-menu-container"><div class="collapse navbar-collapse"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item dropdown"><a class="nav-link" target="_blank" rel="noopener" href="https://dev-yakuza.github.io/ko/">Tech Blog</a></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href="https://dev-yakuza.github.io/app/list/ko/">Apps</a></li><li class="nav-item"><a class="nav-link" href="/contact/">Contact</a></li></ul></div><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"> Menu <i class="fa fa-bars"></i></button></div><div class="collapse navbar-collapse" id="navbarResponsive"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item dropdown"><a class="nav-link" target="_blank" rel="noopener" href="https://dev-yakuza.github.io/ko/">Tech Blog</a></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href="https://dev-yakuza.github.io/app/list/ko/">Apps</a></li><li class="nav-item"><a class="nav-link" href="/contact/">Contact</a></li></ul></div></div></nav><script>document.addEventListener("DOMContentLoaded",function(){var e=window.location.pathname;e.indexOf("/en/")>=0?($(".menu-ko").prop("href",e.replace("/en/","/ko/")),$(".menu-en").prop("href",e),$(".menu-ja").prop("href",e.replace("/en/","/"))):e.indexOf("/ko/")>=0?($(".menu-ko").prop("href",e),$(".menu-en").prop("href",e.replace("/ko/","/en/")),$(".menu-ja").prop("href",e.replace("/ko/","/"))):($(".menu-ko").prop("href","/ko"+e),$(".menu-en").prop("href","/en"+e),$(".menu-ja").prop("href",e)),$("body").on("show.bs.dropdown",".dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideDown()}),$("body").on("hide.bs.dropdown",".dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideUp()})});</script><header class="masthead"><div class="overlay"></div><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><div class="page-heading"><h1></h1></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><h1 align="center"><img width="250" src="https://jaredwray.com/images/keyv.svg" alt="keyv"/><br/><br/></h1><blockquote><p>Simple key-value storage with support for multiple backends</p></blockquote><p><a href="https://github.com/jaredwray/keyv/actions/workflows/tests.yaml"><img src="https://github.com/jaredwray/keyv/actions/workflows/tests.yaml/badge.svg" alt="build"/></a><a href="https://codecov.io/gh/jaredwray/keyv"><img src="https://codecov.io/gh/jaredwray/keyv/branch/main/graph/badge.svg?token=bRzR3RyOXZ" alt="codecov"/></a><a href="https://www.npmjs.com/package/keyv"><img src="https://img.shields.io/npm/dm/keyv.svg" alt="npm"/></a><a href="https://www.npmjs.com/package/keyv"><img src="https://img.shields.io/npm/v/keyv.svg" alt="npm"/></a></p><p>Keyv provides a consistent interface for key-value storage across multiple backends via storage adapters. It supports TTL based expiry, making it suitable as a cache or a persistent key-value store.</p><h2 id="features">Features</h2><p>There are a few existing modules similar to Keyv, however Keyv is different because it:</p><ul><li>Isn’t bloated</li><li>Has a simple Promise based API</li><li>Suitable as a TTL based cache or persistent key-value store</li><li><a href="#add-cache-support-to-your-module">Easily embeddable</a> inside another module</li><li>Works with any storage that implements the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code class="language-plaintext highlighter-rouge">Map</code></a> API</li><li>Handles all JSON types plus <code class="language-plaintext highlighter-rouge">Buffer</code></li><li>Supports namespaces</li><li>Wide range of <a href="#official-storage-adapters"><strong>efficient, well tested</strong></a> storage adapters</li><li>Connection errors are passed through (db failures won’t kill your app)</li><li>Supports the current active LTS version of Node.js or higher</li></ul><h2 id="usage">Usage</h2><p>Install Keyv.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install --save keyv
</code></pre></div></div><p>By default everything is stored in memory, you can optionally also install a storage adapter.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install --save @keyv/redis
npm install --save @keyv/mongo
npm install --save @keyv/sqlite
npm install --save @keyv/postgres
npm install --save @keyv/mysql
npm install --save @keyv/etcd
</code></pre></div></div><p>Create a new Keyv instance, passing your connection string if applicable. Keyv will automatically load the correct storage adapter.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Keyv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">keyv</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// One of the following</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">redis://user:pass@localhost:6379</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">mongodb://user:pass@localhost:27017/dbname</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">sqlite://path/to/database.sqlite</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">postgresql://user:pass@localhost:5432/dbname</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">mysql://user:pass@localhost:3306/dbname</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">etcd://localhost:2379</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Handle DB connection errors</span>
<span class="nx">keyv</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Connection Error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">));</span>

<span class="k">await</span> <span class="nx">keyv</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">expires in 1 second</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span> <span class="c1">// true</span>
<span class="k">await</span> <span class="nx">keyv</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">never expires</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// true</span>
<span class="k">await</span> <span class="nx">keyv</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'never expires'</span>
<span class="k">await</span> <span class="nx">keyv</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// true</span>
<span class="k">await</span> <span class="nx">keyv</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span> <span class="c1">// undefined</span>
</code></pre></div></div><h3 id="namespaces">Namespaces</h3><p>You can namespace your Keyv instance to avoid key collisions and allow you to clear only a certain namespace while using the same database.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">users</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">redis://user:pass@localhost:6379</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">namespace</span><span class="p">:</span> <span class="dl">'</span><span class="s1">users</span><span class="dl">'</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">(</span><span class="dl">'</span><span class="s1">redis://user:pass@localhost:6379</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">namespace</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cache</span><span class="dl">'</span> <span class="p">});</span>

<span class="k">await</span> <span class="nx">users</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// true</span>
<span class="k">await</span> <span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cache</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// true</span>
<span class="k">await</span> <span class="nx">users</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'users'</span>
<span class="k">await</span> <span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'cache'</span>
<span class="k">await</span> <span class="nx">users</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span> <span class="c1">// undefined</span>
<span class="k">await</span> <span class="nx">users</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// undefined</span>
<span class="k">await</span> <span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'cache'</span>
</code></pre></div></div><h3 id="custom-serializers">Custom Serializers</h3><p>Keyv uses <a href="https://github.com/dominictarr/json-buffer"><code class="language-plaintext highlighter-rouge">json-buffer</code></a> for data serialization to ensure consistency across different backends.</p><p>You can optionally provide your own serialization functions to support extra data types or to serialize to something other than JSON.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span> <span class="na">serialize</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">,</span> <span class="na">deserialize</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="p">});</span>
</code></pre></div></div><p><strong>Warning:</strong> Using custom serializers means you lose any guarantee of data consistency. You should do extensive testing with your serialisation functions and chosen storage engine.</p><h2 id="official-storage-adapters">Official Storage Adapters</h2><p>The official storage adapters are covered by <a href="https://github.com/jaredwray/keyv/actions/workflows/tests.yaml">over 150 integration tests</a> to guarantee consistent behaviour. They are lightweight, efficient wrappers over the DB clients making use of indexes and native TTLs where available.</p><table><thead><tr><th>Database</th><th>Adapter</th><th>Native TTL</th></tr></thead><tbody><tr><td>Redis</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/redis">@keyv/redis</a></td><td>Yes</td></tr><tr><td>MongoDB</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/mongo">@keyv/mongo</a></td><td>Yes</td></tr><tr><td>SQLite</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/sqlite">@keyv/sqlite</a></td><td>No</td></tr><tr><td>PostgreSQL</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/postgres">@keyv/postgres</a></td><td>No</td></tr><tr><td>MySQL</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/mysql">@keyv/mysql</a></td><td>No</td></tr><tr><td>Etcd</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/etcd">@keyv/etcd</a></td><td>Yes</td></tr><tr><td>Memcache</td><td><a href="https://github.com/jaredwray/keyv/tree/master/packages/memcache">@keyv/memcache</a></td><td>Yes</td></tr></tbody></table><h2 id="third-party-storage-adapters">Third-party Storage Adapters</h2><p>You can also use third-party storage adapters or build your own. Keyv will wrap these storage adapters in TTL functionality and handle complex types internally.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Keyv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">keyv</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">myAdapter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./my-storage-adapter</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span> <span class="na">store</span><span class="p">:</span> <span class="nx">myAdapter</span> <span class="p">});</span>
</code></pre></div></div><p>Any store that follows the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code class="language-plaintext highlighter-rouge">Map</code></a> api will work.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span> <span class="na">store</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">()</span> <span class="p">});</span>
</code></pre></div></div><p>For example, <a href="https://github.com/sindresorhus/quick-lru"><code class="language-plaintext highlighter-rouge">quick-lru</code></a> is a completely unrelated module that implements the Map API.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Keyv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">keyv</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">QuickLRU</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">quick-lru</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">lru</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QuickLRU</span><span class="p">({</span> <span class="na">maxSize</span><span class="p">:</span> <span class="mi">1000</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span> <span class="na">store</span><span class="p">:</span> <span class="nx">lru</span> <span class="p">});</span>
</code></pre></div></div><p>The following are third-party storage adapters compatible with Keyv:</p><ul><li><a href="https://github.com/sindresorhus/quick-lru">quick-lru</a> - Simple “Least Recently Used” (LRU) cache</li><li><a href="https://github.com/zaaack/keyv-file">keyv-file</a> - File system storage adapter for Keyv</li><li><a href="https://www.npmjs.com/package/keyv-dynamodb">keyv-dynamodb</a> - DynamoDB storage adapter for Keyv</li><li><a href="https://www.npmjs.com/package/keyv-lru">keyv-lru</a> - LRU storage adapter for Keyv</li><li><a href="https://www.npmjs.com/package/keyv-null">keyv-null</a> - Null storage adapter for Keyv</li><li><a href="https://github.com/goto-bus-stop/keyv-firestore">keyv-firestore </a> – Firebase Cloud Firestore adapter for Keyv</li><li><a href="https://github.com/pmorgan3/keyv-mssql">keyv-mssql</a> - Microsoft Sql Server adapter for Keyv</li><li><a href="https://github.com/howlowck/keyv-azuretable">keyv-azuretable</a> - Azure Table Storage/API adapter for Keyv</li><li><a href="https://github.com/TimMikeladze/keyv-arango">keyv-arango</a> - ArangoDB storage adapter for Keyv</li><li><a href="https://github.com/momentohq/node-keyv-adaptor/">keyv-momento</a> - Momento storage adapter for Keyv</li></ul><h2 id="add-cache-support-to-your-module">Add Cache Support to your Module</h2><p>Keyv is designed to be easily embedded into other modules to add cache support. The recommended pattern is to expose a <code class="language-plaintext highlighter-rouge">cache</code> option in your modules options which is passed through to Keyv. Caching will work in memory by default and users have the option to also install a Keyv storage adapter and pass in a connection string, or any other storage that implements the <code class="language-plaintext highlighter-rouge">Map</code> API.</p><p>You should also set a namespace for your module so you can safely call <code class="language-plaintext highlighter-rouge">.clear()</code> without clearing unrelated app data.</p><p>Inside your module:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">AwesomeModule</span> <span class="p">{</span>
	<span class="kd">constructor</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span>
			<span class="na">uri</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">cache</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">cache</span><span class="p">,</span>
			<span class="na">store</span><span class="p">:</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">cache</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">cache</span><span class="p">,</span>
			<span class="na">namespace</span><span class="p">:</span> <span class="dl">'</span><span class="s1">awesome-module</span><span class="dl">'</span>
		<span class="p">});</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>Now it can be consumed like this:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">AwesomeModule</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">awesome-module</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Caches stuff in memory by default</span>
<span class="kd">const</span> <span class="nx">awesomeModule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AwesomeModule</span><span class="p">();</span>

<span class="c1">// After npm install --save keyv-redis</span>
<span class="kd">const</span> <span class="nx">awesomeModule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AwesomeModule</span><span class="p">({</span> <span class="na">cache</span><span class="p">:</span> <span class="dl">'</span><span class="s1">redis://localhost</span><span class="dl">'</span> <span class="p">});</span>

<span class="c1">// Some third-party module that implements the Map API</span>
<span class="kd">const</span> <span class="nx">awesomeModule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AwesomeModule</span><span class="p">({</span> <span class="na">cache</span><span class="p">:</span> <span class="nx">some3rdPartyStore</span> <span class="p">});</span>
</code></pre></div></div><h2 id="compression">Compression</h2><p>Keyv supports <code class="language-plaintext highlighter-rouge">gzip</code> and <code class="language-plaintext highlighter-rouge">brotli</code> compression. To enable compression, pass the <code class="language-plaintext highlighter-rouge">compress</code> option to the constructor.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">KeyvGzip</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@keyv/compress-gzip</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Keyv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">keyv</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">keyvGzip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">KeyvGzip</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">keyv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Keyv</span><span class="p">({</span> <span class="na">compression</span><span class="p">:</span> <span class="nx">KeyvGzip</span> <span class="p">});</span>
</code></pre></div></div><p>You can also pass a custom compression function to the <code class="language-plaintext highlighter-rouge">compression</code> option. Following the pattern of the official compression adapters.</p><h3 id="want-to-build-your-own">Want to build your own?</h3><p>Great! Keyv is designed to be easily extended. You can build your own compression adapter by following the pattern of the official compression adapters based on this interface:</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">CompressionAdapter</span> <span class="p">{</span>
	<span class="k">async</span> <span class="nx">compress</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">options</span><span class="p">?:</span> <span class="kr">any</span><span class="p">);</span>
	<span class="k">async</span> <span class="nx">decompress</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">options</span><span class="p">?:</span> <span class="kr">any</span><span class="p">);</span>
	<span class="k">async</span> <span class="nx">serialize</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">);</span>
	<span class="k">async</span> <span class="nx">deserialize</span><span class="p">(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>In addition to the interface, you can test it with our compression test suite using @keyv/test-suite:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span><span class="nx">keyvCompresstionTests</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@keyv/test-suite</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">KeyvGzip</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@keyv/compress-gzip</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">keyvCompresstionTests</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="k">new</span> <span class="nx">KeyvGzip</span><span class="p">());</span>
</code></pre></div></div><h2 id="api">API</h2><h3 id="new-keyvuri-options">new Keyv([uri], [options])</h3><p>Returns a new Keyv instance.</p><p>The Keyv instance is also an <code class="language-plaintext highlighter-rouge">EventEmitter</code> that will emit an <code class="language-plaintext highlighter-rouge">'error'</code> event if the storage adapter connection fails.</p><h3 id="uri">uri</h3><p>Type: <code class="language-plaintext highlighter-rouge">String</code><br/> Default: <code class="language-plaintext highlighter-rouge">undefined</code></p><p>The connection string URI.</p><p>Merged into the options object as options.uri.</p><h3 id="options">options</h3><p>Type: <code class="language-plaintext highlighter-rouge">Object</code></p><p>The options object is also passed through to the storage adapter. Check your storage adapter docs for any extra options.</p><h4 id="optionsnamespace">options.namespace</h4><p>Type: <code class="language-plaintext highlighter-rouge">String</code><br/> Default: <code class="language-plaintext highlighter-rouge">'keyv'</code></p><p>Namespace for the current instance.</p><h4 id="optionsttl">options.ttl</h4><p>Type: <code class="language-plaintext highlighter-rouge">Number</code><br/> Default: <code class="language-plaintext highlighter-rouge">undefined</code></p><p>Default TTL. Can be overridden by specififying a TTL on <code class="language-plaintext highlighter-rouge">.set()</code>.</p><h4 id="optionscompression">options.compression</h4><p>Type: <code class="language-plaintext highlighter-rouge">@keyv/compress-&lt;compression_package_name&gt;</code><br/> Default: <code class="language-plaintext highlighter-rouge">undefined</code></p><p>Compression package to use. See <a href="#compression">Compression</a> for more details.</p><h4 id="optionsserialize">options.serialize</h4><p>Type: <code class="language-plaintext highlighter-rouge">Function</code><br/> Default: <code class="language-plaintext highlighter-rouge">JSONB.stringify</code></p><p>A custom serialization function.</p><h4 id="optionsdeserialize">options.deserialize</h4><p>Type: <code class="language-plaintext highlighter-rouge">Function</code><br/> Default: <code class="language-plaintext highlighter-rouge">JSONB.parse</code></p><p>A custom deserialization function.</p><h4 id="optionsstore">options.store</h4><p>Type: <code class="language-plaintext highlighter-rouge">Storage adapter instance</code><br/> Default: <code class="language-plaintext highlighter-rouge">new Map()</code></p><p>The storage adapter instance to be used by Keyv.</p><h4 id="optionsadapter">options.adapter</h4><p>Type: <code class="language-plaintext highlighter-rouge">String</code><br/> Default: <code class="language-plaintext highlighter-rouge">undefined</code></p><p>Specify an adapter to use. e.g <code class="language-plaintext highlighter-rouge">'redis'</code> or <code class="language-plaintext highlighter-rouge">'mongodb'</code>.</p><h3 id="instance">Instance</h3><p>Keys must always be strings. Values can be of any type.</p><h4 id="setkey-value-ttl">.set(key, value, [ttl])</h4><p>Set a value.</p><p>By default keys are persistent. You can set an expiry TTL in milliseconds.</p><p>Returns a promise which resolves to <code class="language-plaintext highlighter-rouge">true</code>.</p><h4 id="getkey-options">.get(key, [options])</h4><p>Returns a promise which resolves to the retrieved value.</p><h5 id="optionsraw">options.raw</h5><p>Type: <code class="language-plaintext highlighter-rouge">Boolean</code><br/> Default: <code class="language-plaintext highlighter-rouge">false</code></p><p>If set to true the raw DB object Keyv stores internally will be returned instead of just the value.</p><p>This contains the TTL timestamp.</p><h4 id="deletekey">.delete(key)</h4><p>Deletes an entry.</p><p>Returns a promise which resolves to <code class="language-plaintext highlighter-rouge">true</code> if the key existed, <code class="language-plaintext highlighter-rouge">false</code> if not.</p><h4 id="clear">.clear()</h4><p>Delete all entries in the current namespace.</p><p>Returns a promise which is resolved when the entries have been cleared.</p><h4 id="iterator">.iterator()</h4><p>Iterate over all entries of the current namespace.</p><p>Returns a iterable that can be iterated by for-of loops. For example:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// please note that the "await" keyword should be used here</span>
<span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">keyv</span><span class="p">.</span><span class="nx">iterator</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div><h1 id="how-to-contribute">How to Contribute</h1><p>In this section of the documentation we will cover:</p><p>1) How to set up this repository locally 2) How to get started with running commands 3) How to contribute changes using Pull Requests</p><h2 id="dependencies">Dependencies</h2><p>This package requires the following dependencies to run:</p><p>1) <a href="https://yarnpkg.com/getting-started/install">Yarn V1</a> 3) <a href="https://docs.docker.com/get-docker/">Docker</a></p><h2 id="setting-up-your-workspace">Setting up your workspace</h2><p>To contribute to this repository, start by setting up this project locally:</p><p>1) Fork this repository into your Git account 2) Clone the forked repository to your local directory using <code class="language-plaintext highlighter-rouge">git clone</code> 3) Install any of the above missing dependencies</p><h2 id="launching-the-project">Launching the project</h2><p>Once the project is installed locally, you are ready to start up its services:</p><p>1) Ensure that your Docker service is running. 2) From the root directory of your project, run the <code class="language-plaintext highlighter-rouge">yarn</code> command in the command prompt to install yarn. 3) Run the <code class="language-plaintext highlighter-rouge">yarn bootstrap</code> command to install any necessary dependencies. 4) Run <code class="language-plaintext highlighter-rouge">yarn test:services:start</code> to start up this project’s Docker container. The container will launch all services within your workspace.</p><h2 id="available-commands">Available Commands</h2><p>Once the project is running, you can execute a variety of commands. The root workspace and each subpackage contain a <code class="language-plaintext highlighter-rouge">package.json</code> file with a <code class="language-plaintext highlighter-rouge">scripts</code> field listing all the commands that can be executed from that directory. This project also supports native <code class="language-plaintext highlighter-rouge">yarn</code>, and <code class="language-plaintext highlighter-rouge">docker</code> commands.</p><p>Here, we’ll cover the primary commands that can be executed from the root directory. Unless otherwise noted, these commands can also be executed from a subpackage. If executed from a subpackage, they will only affect that subpackage, rather than the entire workspace.</p><h3 id="yarn"><code class="language-plaintext highlighter-rouge">yarn</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn</code> command installs yarn in the workspace.</p><h3 id="yarn-bootstrap"><code class="language-plaintext highlighter-rouge">yarn bootstrap</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn bootstrap</code> command installs all dependencies in the workspace.</p><h3 id="yarn-testservicesstart"><code class="language-plaintext highlighter-rouge">yarn test:services:start</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn test:services:start</code> command starts up the project’s Docker container, launching all services in the workspace. This command must be executed from the root directory.</p><h3 id="yarn-testservicesstop"><code class="language-plaintext highlighter-rouge">yarn test:services:stop</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn test:services:stop</code> command brings down the project’s Docker container, halting all services. This command must be executed from the root directory.</p><h3 id="yarn-test"><code class="language-plaintext highlighter-rouge">yarn test</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn test</code> command runs all tests in the workspace.</p><h3 id="yarn-clean"><code class="language-plaintext highlighter-rouge">yarn clean</code></h3><p>The <code class="language-plaintext highlighter-rouge">yarn clean</code> command removes yarn and all dependencies installed by yarn. After executing this command, you must repeat the steps in <em>Setting up your workspace</em> to rebuild your workspace.</p><h2 id="contributing-changes">Contributing Changes</h2><p>Now that you’ve set up your workspace, you’re ready to contribute changes to the <code class="language-plaintext highlighter-rouge">keyv</code> repository.</p><p>1) Make any changes that you would like to contribute in your local workspace. 2) After making these changes, ensure that the project’s tests still pass by executing the <code class="language-plaintext highlighter-rouge">yarn test</code> command in the root directory. 3) Commit your changes and push them to your forked repository. 4) Navigate to the original <code class="language-plaintext highlighter-rouge">keyv</code> repository and go the <em>Pull Requests</em> tab. 5) Click the <em>New pull request</em> button, and open a pull request for the branch in your repository that contains your changes. 6) Once your pull request is created, ensure that all checks have passed and that your branch has no conflicts with the base branch. If there are any issues, resolve these changes in your local repository, and then commit and push them to git. 7) Similarly, respond to any reviewer comments or requests for changes by making edits to your local repository and pushing them to Git. 8) Once the pull request has been reviewed, those with write access to the branch will be able to merge your changes into the <code class="language-plaintext highlighter-rouge">keyv</code> repository.</p><p>If you need more information on the steps to create a pull request, you can find a detailed walkthrough in the <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request-from-a-fork">Github documentation</a></p><h2 id="license">License</h2><p>MIT © Jared Wray</p></div></div></div><footer><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto share-title"> SHARE </div><div class="col-lg-8 col-md-10 mx-auto"><ul class="list-inline text-center"><li class="list-inline-item"><a href="https://twitter.com/intent/tweet?text=&url=https://ink.posstree.com/node_modules/keyv/" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> Twitter </div></a></li><li class="list-inline-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://ink.posstree.com/node_modules/keyv/" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> Facebook </div></a></li><li class="list-inline-item"><a href="https://ink.posstree.com/feed.xml" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-rss-square fa-stack-1x fa-inverse" aria-hidden="true"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> RSS </div></a></li></ul><p class="copyright text-muted"> Copyright &copy; dev.yakuza@gmail.com 2025 </p></div></div></div></footer><script src="/assets/vendor/jquery/jquery.min.js"></script><script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="/assets/vendor/startbootstrap-clean-blog/js/clean-blog.min.js"></script><script src="/assets/scripts.js?v=20250111"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/railscasts.min.css"></body></html>